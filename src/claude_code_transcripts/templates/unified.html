<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code Transcript - Unified View</title>
    <style>{{ unified_css|safe }}</style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h2>Transcript</h2>
            <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Toggle sidebar">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"></path></svg>
            </button>
        </div>

        <div class="sidebar-search">
            <div class="search-container">
                <input type="text" id="unified-search" placeholder="Search transcript..." aria-label="Search transcript">
                <button id="search-clear-btn" class="search-clear" aria-label="Clear search">&times;</button>
            </div>
        </div>

        <div class="message-filters">
            <label class="filter-toggle active" data-filter="user">
                <span class="filter-indicator"></span>
                <span>User</span>
            </label>
            <label class="filter-toggle active" data-filter="assistant">
                <span class="filter-indicator"></span>
                <span>Assistant</span>
            </label>
            {%- for tool_type in session_tool_types %}
            <label class="filter-toggle active" data-filter="{{ tool_type }}">
                <span class="filter-indicator"></span>
                <span>{{ tool_type }}</span>
            </label>
            {%- endfor %}
        </div>

        <div class="sidebar-stats">
            <span>{{ prompt_count }} prompts</span>
            <span>{{ message_count }} messages</span>
            <span>{{ tool_count }} tools</span>
            {%- if total_tokens > 0 %}
            <span>{{ total_tokens|default(0) }} tokens</span>
            {%- endif %}
        </div>

        <nav class="sidebar-nav">
            <ul id="nav-list">
            {%- for item in nav_items %}
                <li>
                    <a href="#prompt-{{ item.num }}" class="nav-link" data-section="prompt-{{ item.num }}">
                        <span class="nav-num">#{{ item.num }}</span>
                        <span class="nav-preview">{{ item.preview }}</span>
                        <time class="nav-time" datetime="{{ item.timestamp }}" data-timestamp="{{ item.timestamp }}">{{ item.timestamp }}</time>
                    </a>
                </li>
            {%- endfor %}
            </ul>
        </nav>
    </aside>

    <!-- Mobile sidebar toggle -->
    <button id="mobile-sidebar-toggle" class="mobile-sidebar-toggle" aria-label="Open sidebar">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"></path></svg>
    </button>

    <!-- Main Content -->
    <main id="main-content" class="main-content">
        <header class="main-header">
            {%- if breadcrumbs %}
            <nav class="breadcrumb">
                <a href="{{ breadcrumbs.archive_url }}">Archive</a>
                <span class="breadcrumb-sep">/</span>
                <a href="{{ breadcrumbs.project_url }}">{{ breadcrumbs.project_name }}</a>
                <span class="breadcrumb-sep">/</span>
                <span class="breadcrumb-current">Session</span>
            </nav>
            {%- endif %}
            <h1>Claude Code Transcript</h1>
            <p class="header-stats">{{ prompt_count }} prompts &middot; {{ message_count }} messages &middot; {{ tool_count }} tool calls{% if total_tokens > 0 %} &middot; {{ token_stats }}{% endif %}</p>
            {% if total_tokens > 0 %}
            <div class="header-mini-chart"
                 data-input="{{ input_tokens }}"
                 data-output="{{ output_tokens }}"
                 data-cache-read="{{ cache_read_tokens }}"
                 data-cache-write="{{ cache_creation_tokens }}"
                 data-cost="{{ token_cost }}"
                 data-total="{{ total_tokens }}">
            </div>
            {% endif %}
        </header>

        <div id="search-results-banner" class="search-results-banner hidden">
            <span id="search-results-count"></span>
            <button id="clear-search" class="clear-search-btn">Clear</button>
        </div>

        <div id="transcript-content" class="transcript-content">
            {%- for section in sections %}
            <section id="prompt-{{ section.num }}" class="transcript-section" data-prompt="{{ section.num }}">
                <div class="section-header">
                    <span class="section-num">#{{ section.num }}</span>
                    <time datetime="{{ section.timestamp }}" data-timestamp="{{ section.timestamp }}">{{ section.timestamp }}</time>
                </div>
                <div class="section-content">
                    {{ section.content|safe }}
                </div>
            </section>
            {%- endfor %}
        </div>

        <footer class="main-footer">
            <p>Generated by <a href="https://github.com/anthropics/claude-code-transcripts">claude-code-transcripts</a></p>
        </footer>
    </main>

    <script>{{ unified_js|safe }}</script>
</body>
</html>
